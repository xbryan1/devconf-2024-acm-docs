<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploy another Openshift cluster :: Multicluster Application Deployment with Advanced Cluster Management and GitOps</title>
    <link rel="canonical" href="https://xbryan1.github.io/rhte-2023-acm-docs/03-installcluster.html">
    <link rel="prev" href="02-deploy.html">
    <link rel="next" href="04-application.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="./_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="./_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://xbryan1.github.io/rhte-2023-acm-docs">Multicluster Application Deployment with Advanced Cluster Management and GitOps</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Environment Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#architecture">Hands-on Lab Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#occontext">Switching context between clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#sources">Hands-on Lab Git repository</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-deploy.html">2. Install Advanced Management and GitOps Operators</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-deploy.html#install">Install RHACM Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-deploy.html#console">Access to the ACM Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-deploy.html#gitops">Install GitOps Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-deploy.html#gitopsacm">Integrate GitOps and ACM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-deploy.html#managedcluster">Registering local-cluster to GitOps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-deploy.html#deployall">Creating an ArgoCD Setup app-of-apps </a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-installcluster.html">3. Install a new Openshift Cluster</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#credentials">Setup credentials</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#credscli">Setup credentials via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#install">Deploy new Openshift Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#installgui">Deploy a new OpenShift cluster via web interface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#installcli">Deploy a new OpenShift cluster via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#occontextnew">Switching context for the new cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#managedcluster">Registering rhte2023-cluster01 to GitOps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-application.html">4. Deploy a Multicluster Application with GitOps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationacm01">Application 1 - Deploying a ChatBot application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationreplicas">Application 1 - Change number of replicas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationacm02">Application 2 - Deploying a ChatDraw application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationimages">Application 2 - Change container image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationacm03">Application - Deploying multiple Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationimages">Application - Sync and Diff</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-policies.html">5. Setup Advanced Cluster Management Policies</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#firstpolicygui">Setup the first policy via web</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#secondpolicygui">Setup the second policy via web</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#firstpolicycli">Setup the first policy via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#secondpolicycli">Setup the second policy via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#firstpolicygitops">Setup the first policy using GitOps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#secondpolicygitops">Setup the first policy using GitOps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-multiclusterapplication.html">6. Advanced Cluster Management Multicluster Application</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#06-policies.adoc#hibernategui">Hibernate clusters via web</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#06-policies.adoc#hibernatecli">Hibernate clusters via CLI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Multicluster Application Deployment with Advanced Cluster Management and GitOps</a></li>
    <li><a href="03-installcluster.html">3. Install a new Openshift Cluster</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/xbryan1/rhte-2023-acm-docs/edit/master/documentation/modules/ROOT/pages/03-installcluster.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Deploy another Openshift cluster</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>To deploy multicluster applications, you will need another OpenShift cluster deployed.</p>
</div>
<div class="paragraph">
<p>In this LAB, Amazon Web Services (AWS) Public Cloud Provider is being used. You will need to add the AWS credentials into Red Hat Advanced Cluster Management, and deploy a second OpenShift cluster after adding the credentials.</p>
</div>
<div class="paragraph">
<p>Using Red Hat Advanced Cluster Management and having two OpenShift clusters installed, you will have all the necessary requirements to acomplish the tasks in this LAB.</p>
</div>
</div>
</div>
<h1 id="credentials" class="sect0"><a class="anchor" href="#credentials"></a>Setup credentials</h1>
<div class="paragraph">
<p>In order to create a new OpenShift cluster on AWS, you will need to set-up the AWS credentials into Red Hat Advanced Cluster Management first. This credentials will allow Red Hat Advanced Cluster Management to install the OpenShift cluster on AWS.</p>
</div>
<div class="paragraph">
<p>You can setup the AWS credentials using the Red Hat Advanced Cluster Management web interface, or using the command line interface (CLI).</p>
</div>
<div class="paragraph">
<p>To setup the credentials, you will need the following information:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Name of AWS credentials</p>
</li>
<li>
<p>Namespace where the credentials will be saved</p>
</li>
<li>
<p>AWS Access Key ID</p>
</li>
<li>
<p>AWS Secret Key</p>
</li>
<li>
<p>Base domain</p>
</li>
<li>
<p>A Global Pull Secret. If you don&#8217;t have one, you can get it from <a href="https://console.redhat.com/openshift/install/pull-secret" class="bare">https://console.redhat.com/openshift/install/pull-secret</a></p>
</li>
<li>
<p>A SSH public and private key. If you don&#8217;t have one, you can generate it with the following command:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ssh-keygen</code></pre>
</div>
</div>
<div class="sect1">
<h2 id="credsgui"><a class="anchor" href="#credsgui"></a>Setup credentials via web interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To setup the AWS credentials using the web interface, you need to enter to the Red Hat Advanced Cluster Management route first. You can find it in the open-cluster-management namespace.</p>
</div>
<div class="paragraph">
<p>After entering into Red Hat Advanced Cluster Management web interface, you need to enter into the "Credentials" section.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/creds01.png" alt="creds01">
</div>
</div>
<div class="paragraph">
<p>To create the new credentials, you should click into "Add credential" button.</p>
</div>
<div class="paragraph">
<p>As the second OpenShift cluster will be installed in AWS, you should click into "Amazon Web Services".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/creds02.png" alt="creds02">
</div>
</div>
<div class="paragraph">
<p>On the next form, you should choose a Credential name, the namespace where the credential is going to be stored and the Base DNS domain. You can type any Credential name, you can use the default namespace and you will need to add your Base DNS domain received in your email as the Base DNS domain.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/creds03.png" alt="creds03">
</div>
</div>
<div class="paragraph">
<p>The next form will ask about the Amazon Web Services Access key ID and Secret access key. Both data are in the email received previously.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/creds04.png" alt="creds04">
</div>
</div>
<div class="paragraph">
<p>The proxy form, can be left emtpy, we are not going to use it in this LAB.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/creds05.png" alt="creds05">
</div>
</div>
<div class="paragraph">
<p>The next step is to add the Global Pull secret and the SSH keys.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/creds06.png" alt="creds06">
</div>
</div>
<div class="paragraph">
<p>Finally, you can review the data an add the credentials.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="credscli"><a class="anchor" href="#credscli"></a>Setup credentials via CLI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To setup the AWS credentials using the CLI, you can use the following YAML example file to create one crentials.yaml file:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: &lt;1 - Name of AWS credentials&gt;
  namespace: &lt;2 - Namespace where the credentials will be saved&gt;
  labels:
    cluster.open-cluster-management.io/type: aws
    cluster.open-cluster-management.io/credentials: ""
stringData:
  aws_access_key_id: &lt;3 - AWS Access Key ID&gt;
  aws_secret_access_key: &lt;4 - AWS Secret Key&gt;
  baseDomain: &lt;5 - Base domain&gt;
  pullSecret: &gt;
    &lt;6 Global pull secret&gt;
  ssh-privatekey: |
    &lt;7 - A SSH private key&gt;
  ssh-publickey: &gt;
    ssh-rsa
    &lt;7 - A SSH public key&gt;
  httpProxy: ""
  httpsProxy: ""
  noProxy: ""
  additionalTrustBundle: ""</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you have created the file, you can create it with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create -f cretentials.yaml</code></pre>
</div>
</div>
</div>
</div>
<h1 id="install" class="sect0"><a class="anchor" href="#install"></a>Deploy a new OpenShift cluster</h1>
<div class="paragraph">
<p>To deploy applications using a multicluster architecture, you will need a second OpenShift cluster. In this LAB you will have one OpenShift cluster, and you will use Red Hat Advanced Cluster Management to deploy the second OpenShift cluster.</p>
</div>
<div class="paragraph">
<p>You can create the second OpenShift cluster using the Red Hat Advanced Cluster Management web interface or using the command line interface (CLI).</p>
</div>
<div class="sect1">
<h2 id="installgui"><a class="anchor" href="#installgui"></a>Deploy a new OpenShift cluster via web interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To create the second OpenShift cluster using the web interface, you need to enter into the Red Hat Advanced Cluster Management route first. You can find it in the open-cluster-management namespace.</p>
</div>
<div class="paragraph">
<p>After entering into Red Hat Advanced Cluster Management web interface, you will need to enter into "Infrastructure" &#8594; "Clusters" section and click into "Create cluster" button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create01.png" alt="create01">
</div>
</div>
<div class="paragraph">
<p>As the cluster will be installed on Amazon Web Services, you will need to choose Amazon Web Services.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create02.png" alt="create02">
</div>
</div>
<div class="paragraph">
<p>In the Cluster details form, you will need to choose a Cluster name, a Cluster set and the Base DNS domain.
In the Cluster name, you can choose <code>rhte2023-cluster01</code> as the Cluster name.
In the Cluster set, you can choose the default Cluster set.
In the Base DNS domain, you need to use the Base DNS domain received by email.
In the "Release image", select the 4.10.X release image.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create03.png" alt="create03">
</div>
</div>
<div class="paragraph">
<p>The next step is to configure the Region, Architecture and node sizing. You can use eu-west-2 as the Region and amd64 as the Architecture. The node sizing can be modified, but it is not necessary in this LAB.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create04.png" alt="create04">
</div>
</div>
<div class="paragraph">
<p>On the Networking form, you can use the default values.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create05.png" alt="create05">
</div>
</div>
<div class="paragraph">
<p>The Proxy is not going to be used in this LAB, so you don&#8217;t need to define the Proxy values.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create06.png" alt="create06">
</div>
</div>
<div class="paragraph">
<p>The Automation is not going to be used in this LAB also, so you don&#8217;t need to define any values.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create07.png" alt="create07">
</div>
</div>
<div class="paragraph">
<p>Finally, you can review the data and create the cluster</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/install/create08.png" alt="create08">
</div>
</div>
<div class="paragraph">
<p>The cluster installation will take around 30 minutes. So go the next section, you can do it while the cluster is being installed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installcli"><a class="anchor" href="#installcli"></a>Deploy a new OpenShift cluster via CLI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To deploy a new OpenShift cluster via CLI, you will need to create a install-config.yaml file first. You can use this example as a template:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
metadata:
  name: 'rhte2023-cluster01'
baseDomain: &lt;1 - Base DNS domain&gt;
controlPlane:
  architecture: amd64
  hyperthreading: Enabled
  name: master
  replicas: 3
  platform:
    aws:
      rootVolume:
        iops: 4000
        size: 100
        type: io1
      type: m5.xlarge
compute:
- hyperthreading: Enabled
  architecture: amd64
  name: 'worker'
  replicas: 3
  platform:
    aws:
      rootVolume:
        iops: 2000
        size: 100
        type: io1
      type: m5.xlarge
networking:
  networkType: OpenShiftSDN
  clusterNetwork:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  machineNetwork:
  - cidr: 10.0.0.0/16
  serviceNetwork:
  - 172.30.0.0/16
platform:
  aws:
    region: eu-west-2
pullSecret: "" # skip, hive will inject based on it's secrets
sshKey: |-
    &lt;2 - Your SSH public key&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After creating the file, you will need to encode it to base64. You can convert it with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat install-config.yaml | base64</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save the output, you will need it on the next step.</p>
</div>
<div class="paragraph">
<p>Now, you can create the needed resources to create the second cluster. You will need to create a rhte2023-cluster01.yaml file. You can follow this example, and modify it with the variables of your environment:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: hive.openshift.io/v1
kind: ClusterDeployment
metadata:
  name: 'rhte2023-cluster01'
  namespace: 'rhte2023-cluster01'
  labels:
    cloud: 'AWS'
    region: 'eu-west-1'
    vendor: OpenShift
    cluster.open-cluster-management.io/clusterset: 'default'
spec:
  baseDomain: &lt;1 - Base DNS Domain&gt;
  clusterName: 'rhte2023-cluster01'
  controlPlaneConfig:
    servingCertificates: {}
  installAttemptsLimit: 1
  installed: false
  platform:
    aws:
      credentialsSecretRef:
        name: rhte2023-cluster01-aws-creds
      region: eu-west-1
  provisioning:
    installConfigSecretRef:
      name: rhte2023-cluster01-install-config
    sshPrivateKeySecretRef:
      name: rhte2023-cluster01-ssh-private-key
    imageSetRef:
       #quay.io/openshift-release-dev/ocp-release:4.10.47-x86_64
      name: img4.10.47-x86-64-appsub
  pullSecretRef:
    name: rhte2023-cluster01-pull-secret
---
apiVersion: cluster.open-cluster-management.io/v1
kind: ManagedCluster
metadata:
  labels:
    cloud: Amazon
    region: eu-west-1
    name: 'rhte2023-cluster01'
    vendor: OpenShift
    cluster.open-cluster-management.io/clusterset: 'default'
  name: 'rhte2023-cluster01'
spec:
  hubAcceptsClient: true
---
apiVersion: hive.openshift.io/v1
kind: MachinePool
metadata:
  name: rhte2023-cluster01-worker
  namespace: 'rhte2023-cluster01'
spec:
  clusterDeploymentRef:
    name: 'rhte2023-cluster01'
  name: worker
  platform:
    aws:
      rootVolume:
        iops: 2000
        size: 100
        type: io1
      type: m5.xlarge
  replicas: 3
---
apiVersion: v1
kind: Secret
metadata:
  name: rhte2023-cluster01-pull-secret
  namespace: 'rhte2023-cluster01'
stringData:
  .dockerconfigjson: |-
    &lt;2 - Global pull secret&gt;
type: kubernetes.io/dockerconfigjson
---
apiVersion: v1
kind: Secret
metadata:
  name: rhte2023-cluster01-install-config
  namespace: 'rhte2023-cluster01'
type: Opaque
data:
  # Base64 encoding of install-config yaml
  install-config.yaml: &lt;3 - Base64 encoded file&gt;
---
apiVersion: v1
kind: Secret
metadata:
  name: rhte2023-cluster01-ssh-private-key
  namespace: 'rhte2023-cluster01'
stringData:
  ssh-privatekey: |-
    &lt;4 - SSH private key&gt;
type: Opaque
---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: rhte2023-cluster01-aws-creds
  namespace: 'rhte2023-cluster01'
stringData:
  aws_access_key_id: &lt;5 - AWS Access key ID&gt;
  aws_secret_access_key: &lt;6 - AWS Secret Key&gt;
---
apiVersion: agent.open-cluster-management.io/v1
kind: KlusterletAddonConfig
metadata:
  name: 'rhte2023-cluster01'
  namespace: 'rhte2023-cluster01'
spec:
  clusterName: 'rhte2023-cluster01'
  clusterNamespace: 'rhte2023-cluster01'
  clusterLabels:
    cloud: Amazon
    vendor: OpenShift
  applicationManager:
    enabled: true
  policyController:
    enabled: true
  searchCollector:
    enabled: true
  certPolicyController:
    enabled: true
  iamPolicyController:
    enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, apply the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create -f rhte2023-cluster01.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second cluster installation, will be launched. The cluster installation will take around 30 minutes. So, go the next section, you can do it while the cluster is being installed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Remember completing both sections below once the new Cluster is deployed.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="occontextnew"><a class="anchor" href="#occontextnew"></a>Switching context for the new cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the clusters installation in completed and in order to easily switch between Openshift clusters in this lab, we will create a new context for the new rhte2023-cluster01.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login into the <code>rhte2023-cluster01</code></p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc login -u kubeadmin -p &lt;password&gt; --insecure-skip-tls-verify <a href="https://&lt;your_new_cluster&gt;:6443" class="bare">https://&lt;your_new_cluster&gt;:6443</a></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Rename the current context to <code>cluster01</code></p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc config rename-context $(oc config current-context) cluster01</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>List <code>cluster01</code> context</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc config get-contexts cluster01</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Check the new oc context works properly</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context cluster01 get nodes</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managedcluster"><a class="anchor" href="#managedcluster"></a>Registering rhte2023-cluster01 to GitOps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s add the new cluster <code>rhte2023-cluster01</code> to the existing <code>ClusterSet</code> <strong>rhte2023-gitops-clusters-vendor</strong> as follows:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm label ManagedCluster rhte2023-cluster01 cluster.open-cluster-management.io/clusterset=rhte2023-gitops-clusters --overwrite</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="02-deploy.html">2. Install Advanced Management and GitOps Operators</a></span>
  <span class="next"><a href="04-application.html">4. Deploy a Multicluster Application with GitOps</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="./_/js/vendor/clipboard.js"></script>
<script src="./_/js/site.js"></script>
<script async src="./_/js/vendor/highlight.js"></script>
  </body>
</html>
