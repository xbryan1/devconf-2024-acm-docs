<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Install Advanced Custer Management and GitOps Operators :: Multicluster Application Deployment with Advanced Cluster Management and GitOps</title>
    <link rel="canonical" href="https://xbryan1.github.io/devconf-2024-acm-docs/02-deploy.html">
    <link rel="prev" href="01-setup.html">
    <link rel="next" href="03-installcluster.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="./_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="./_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://xbryan1.github.io/devconf-2024-acm-docs">Multicluster Application Deployment with Advanced Cluster Management and GitOps</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Environment Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#architecture">Hands-on Lab Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#occontext">Switching context between clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#sources">Hands-on Lab Git repository</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-deploy.html">2. Install Advanced Management and GitOps Operators</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#install">Install RHACM Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#console">Access to the ACM Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#gitops">Install GitOps Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#gitopsacm">Integrate GitOps and ACM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#managedcluster">Registering local-cluster to GitOps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#deployall">App Of Everything</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-installcluster.html">3. Install a new Openshift Cluster</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-installcluster.html#credentials">Setup credentials</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-installcluster.html#credscli">Setup credentials via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-installcluster.html#install">Deploy new Openshift Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-installcluster.html#installgui">Deploy a new OpenShift cluster via web interface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-installcluster.html#installcli">Deploy a new OpenShift cluster via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-installcluster.html#occontextnew">Switching context for the new cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-installcluster.html#registertnew">Registering rhte2023-cluster01 to GitOps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-application.html">4. Deploy a Multicluster Application with GitOps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationacm01">Application 1 - Deploying a ChatBot application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationreplicas">Application 1 - Change number of replicas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationacm02">Application 2 - Deploying a ChatDraw application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationimages">Application 2 - Change container image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationacm03">Application - Deploying multiple Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-application.html#applicationsync">Application - Sync and Diff</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-policies.html">5. Setup Advanced Cluster Management Policies</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#firstpolicygui">Setup the first policy via web</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#secondpolicygui">Setup the second policy via web</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#firstpolicycli">Setup the first policy via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#secondpolicycli">Setup the second policy via CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#firstpolicygitops">Setup the first policy using GitOps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-policies.html#secondpolicygitops">Setup the first policy using GitOps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-multiclusterapplication.html">6. Advanced Cluster Management Multicluster Application</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#06-policies.adoc#hibernategui">Hibernate clusters via web</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#06-policies.adoc#hibernatecli">Hibernate clusters via CLI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Multicluster Application Deployment with Advanced Cluster Management and GitOps</a></li>
    <li><a href="02-deploy.html">2. Install Advanced Management and GitOps Operators</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/xbryan1/devconf-2024-acm-docs/edit/master/documentation/modules/ROOT/pages/02-deploy.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Install Advanced Custer Management and GitOps Operators</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section will guide you through the Advanced Custer Management and GitOps CD Operators installation and the ACM/GitOps integration in order to deploy applications multicluter.</p>
</div>
<div class="paragraph">
<p>Hereâ€™s a list of required operators to install through the Operator Lifecycle Manager (OLM), which manages the installation, upgrade, and removal:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Advanced Custer Management Operator</strong></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy01.png" alt="deploy01">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>GitOps Operator</strong></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy02.png" alt="deploy02">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The OpenShift Container Platform provided in this lab meets the minimal <a href="https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.6/html/install/installing#requirements-and-recommendations">requirements</a> from the official documentation. The cluster hub components will be installed on worker nodes, no <a href="https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.6/html/install/installing#installing-on-infra-node">infrastructure</a> nodes will be provided.</p>
</li>
<li>
<p>OpenShift Container Platform required access: Cluster administrator (cluster-admin) permissions.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install"><a class="anchor" href="#install"></a>Install Advanced Custer Management Operator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will go through the Advanced Custer Management Operator installation following below steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Install Advanced Custer Management Operator</strong>:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s install the Advanced Cluster Management Operator.</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm apply -k 02_bootstrap/base/acm_operator/base</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will create the following resouces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Namespace</code> - open-cluster-management</p>
</li>
<li>
<p><code>OperatorGroup</code> - open-cluster-management-devconf2024</p>
</li>
<li>
<p><code>Subscription</code> - Advanced Cluster Management Operator</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wait until all pods are in <code>Running</code> status and <code>Ready</code>. It can take a couple of minutes approx.</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch oc --context acm get pod -n open-cluster-management</code></pre>
</div>
</div>
<div class="paragraph">
<p>After installing the Advanced Cluster Management Operator, we also need to create the CRD object <code>MultiClusterHub</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Create <code>MultiClusterHub</code></strong>:</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm apply -k 02_bootstrap/base/acm_multiclusterhub/base</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait until the Advanced Cluster Management Operatator is <code>Runnig</code> status, in the meanwhile the status is <code>Installing</code>. It can take up to 10 minutes.</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">watch oc --context acm get mch -o=jsonpath='{.items[0].status.phase}' -n open-cluster-management</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the status change to <code>Running</code>, verify all pods are <code>Running</code> and <code>Ready</code>.</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch oc --context acm get pod -n open-cluster-management</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="console"><a class="anchor" href="#console"></a>Access to the Advanced Cluster Management Web Console</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Advanced Cluster Management Console is integrated with the Openshift Console, so once the Advanced Cluster Management Operator is installed, the Openshift Console will show a new item "All Clusters" on the side navigation menu as below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Access to Advanced Cluster Management Console</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Console: <a href="https://console-openshift-console.apps.&lt;your_domain&gt;/" class="bare">https://console-openshift-console.apps.&lt;your_domain&gt;/</a></p>
</li>
<li>
<p>User: kubeadmin</p>
</li>
<li>
<p>Password: &lt;your_password&gt;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy00.png" alt="deploy00">
</div>
</div>
<div class="paragraph">
<p><strong>All Cluster</strong> will provide you access to the Advanced Cluster Management Console and <strong>local-cluster</strong> will provide you access to the Openshift Cluster.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s switch to the Advanced Cluster Management Console and Login with Openshift to check that we can access properly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy21.png" alt="deploy21">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gitops"><a class="anchor" href="#gitops"></a>Install GitOps Operator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The next step is the <a href="https://docs.openshift.com/container-platform/4.14/cicd/gitops/installing-openshift-gitops.html">OpenShift GitOps Operator</a> installation. OpenShift GitOps uses <a href="https://argo-cd.readthedocs.io/en/stable/">Argo CD</a> to manage specific cluster-scoped resources. Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s install it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Setup GitOps Operator</strong>:</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm apply -k 02_bootstrap/base/gitops_operator/base/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait until pods in <code>openshift-gitops</code> namespace are in <code>Running</code> status and <code>Ready</code>. It can takes a up 2 minutes.</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch oc --context acm get pods -n openshift-gitops</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Change tracking resources from label to annotation</strong>:</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc patch argocd openshift-gitops -n openshift-gitops --type='json' -p='[{"op": "add", "path": "/spec/resourceTrackingMethod", "value": "annotation" }]'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Access to ArgoCD Console</strong>:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ArgoCD Console is accessible from the Openshift Console</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy13.png" alt="deploy13">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy14.png" alt="deploy14">
</div>
</div>
<div class="paragraph">
<p>Login into the ArgoCD Console with the Openshift credentials.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy15.png" alt="deploy15">
</div>
</div>
<div class="paragraph">
<p>Also, an Openshift <code>Route</code> is created:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm get route -n openshift-gitops</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gitopsacm"><a class="anchor" href="#gitopsacm"></a>Integrate Openshift GitOps and Advanced Cluster Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once we have completed the Advanced Cluster Management and Openshift Gitops Operators installation, we will go through the integration process between them. So, this process will let us:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy and discover ArgoCD multicluster applications</p>
</li>
<li>
<p>Setup Git or Helm Applications based repositories</p>
</li>
<li>
<p>Configure sync policies for our applications</p>
</li>
<li>
<p>Configure placement based on labels or clustersets</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Advanced Cluster Management introduces a new <code>gitopscluster</code> resource kind, which connects to a <code>placement</code> resource to determine which clusters to import into Argo CD. This integration allows you to expand your fleet, while having Argo CD automatically engage in working with your new clusters. This means if you leverage Argo CD <code>ApplicationSets</code>, your application payloads are automatically applied to your new clusters as they are registered by Advanced Cluster Management in your Argo CD instances.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy18.png" alt="deploy18">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s run the following commands to perform the Openshift GitOps Operator integration with Advanced Cluster Management</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm apply -k 02_bootstrap/base/gitops_acm/base/</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will create:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>ManagedClusterSet</code> - <strong>devconf2024-gitops-clusters</strong>. <code>ManagedClusterSet</code> resources allow the grouping of cluster resources. We will add both Openshift Cluster <code>local-cluster</code> and <code>devconf2024-cluster01</code> into this <code>ManagedClusterSet</code> which enables deployment across all of the Openshift Cluster.</p>
</li>
<li>
<p>a <code>ManagedClusterSetBinding</code> - <strong>devconf2024-gitops-clusters</strong>. <code>ManagedClusterSetBinding</code> resource will bind a <code>ManagedClusterSet</code> <strong>devconf2024-gitops-clusters</strong> to a <code>namespace</code> <strong>openshift-gitops</strong>. It means that applications and policies that are created in the <code>openshift-gitops</code> namespace can only access managed clusters that are included in the bound managed cluster set resource.</p>
</li>
<li>
<p>a <code>Placement</code> - <strong>devconf2024-gitops-clusters-placement</strong> based on a ManagedCluster label <strong>vendor=Openshift</strong> and claim <strong>platform=AWS</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a Placement&#8217;s example:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  name: devconf2024-gitops-clusters-placement
  namespace: openshift-gitops
spec:
  predicates:
    - requiredClusterSelector:
        labelSelector:
          matchLabels:
            vendor: OpenShift
        claimSelector:
          matchExpressions:
            - key: platform.open-cluster-management.io
              operator: In
              values:
                - AWS</code></pre>
</div>
</div>
<div class="paragraph">
<p>We will see more <code>Placements</code> examples on the next sections.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<a href="https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.10/html-single/multicluster_engine/index#placement-binding">Placement Examples</a> to select a cluster wih the largest allocatable memory and/or CPU.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you integrate ACM with the GitOps operator for every managed cluster that is bound to the GitOps namespace through the placement and ManagedClusterSetBinding custom resources, a secret with a token to access the ManagedCluster is created in the namespace. This is required for the GitOps controller to sync resources to the managed cluster. When a user is given administrator access to a GitOps namespace to perform application lifecycle operations, the user also gains access to this secret and admin level to the managed cluster
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managedcluster"><a class="anchor" href="#managedcluster"></a>Registering local-cluster to GitOps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After the ACM/GitOps integration is done, let&#8217;s add <code>local-cluster</code> to <code>ClusterSet</code> <strong>devconf2024-gitops-clusters</strong>.</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm label ManagedCluster local-cluster cluster.open-cluster-management.io/clusterset=devconf2024-gitops-clusters --overwrite</code></pre>
</div>
</div>
<div class="paragraph">
<p>and check that cluster <code>local-cluster</code> is added as an ArgoCD Cluster from the <strong>ArgoCD Console &gt; Settings &gt; Clusters</strong> where we expect to see <code>local-cluster</code> as one of the clusters</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy16.png" alt="deploy16">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy17.png" alt="deploy17">
</div>
</div>
<div class="paragraph">
<p>and the <code>local-cluster</code> being part of the <code>ClusterSet devconf2024-gitops-clusters</code> Cluster Set through <code>Openshift Console &gt; Advanced Cluster Management &gt; Clusters &gt; Cluster sets</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy20.png" alt="deploy20">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deployall"><a class="anchor" href="#deployall"></a>Argo CD â€” App Of Everything</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is the last step of this section where will automate with ArgoCD everything that we were doing so far. Let&#8217;s change the <code>ApplicationSet</code> YAML file according to your settings.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Edit the Application yaml file</strong></p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">vi 02_bootstrap/argocd/devconf2024-bootstrap-gitops.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>and change <code>server</code> to your cluster <code><a href="https://api.&lt;your_cluster&gt;:6443" class="bare">https://api.&lt;your_cluster&gt;:6443</a></code> and <code>repoURL</code> to your git repository <code><a href="https://github.com/&lt;your_github_account&gt;/devconf-2024-acm-apps.git" class="bare">https://github.com/&lt;your_github_account&gt;/devconf-2024-acm-apps.git</a></code> forked previously:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: devconf2024-bootstrap-gitops
  namespace: openshift-gitops
spec:
  destination:
    namespace: openshift-gitops
    server: <a href="https://api.&lt;your_cluster&gt;:6443" class="bare">https://api.&lt;your_cluster&gt;:6443</a>
  project: default
  source:
    path: devconf2024/02_bootstrap/base
    repoURL: <a href="https://github.com/&lt;your_github_account&gt;/devconf-2024-acm-apps.git" class="bare">https://github.com/&lt;your_github_account&gt;/devconf-2024-acm-apps.git</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>finally, let&#8217;s create the Application:</p>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc --context acm apply -f 02_bootstrap/argocd/devconf2024-bootstrap-gitops.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s check the results from the Advaced Cluster Management Console and ArgoCD Console:</p>
</div>
<div class="paragraph">
<p><strong>ACM &gt; Applications &gt; Search &gt; bootstrap</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy24.png" alt="deploy24">
</div>
</div>
<div class="paragraph">
<p><strong>ArgoCD Console &gt; Applications</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy/deploy23.png" alt="deploy23">
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="01-setup.html">1. Environment Setup</a></span>
  <span class="next"><a href="03-installcluster.html">3. Install a new Openshift Cluster</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="./_/js/vendor/clipboard.js"></script>
<script src="./_/js/site.js"></script>
<script async src="./_/js/vendor/highlight.js"></script>
  </body>
</html>
